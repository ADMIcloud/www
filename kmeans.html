
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>K-Means &mdash; ADMICloud  documentation</title>
    
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ADMICloud  documentation" href="index.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">

    <p style="text-align:center;"><img src="_static/images/cover.jpg"></p>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="k-means">
<h1>K-Means<a class="headerlink" href="#k-means" title="Permalink to this headline">¶</a></h1>
<p>This section describes how to implement the K-means algorithm using Hadoop.</p>
<a class="reference internal image-reference" href="_images/hadoopkmeans.png"><img alt="hadoop kmeans" class="align-center" src="_images/hadoopkmeans.png" style="width: 520px; height: 300px;" /></a>
<div class="section" id="understanding-k-means">
<h2>Understanding K-Means<a class="headerlink" href="#understanding-k-means" title="Permalink to this headline">¶</a></h2>
<p>K-Means is a very powerful and easily understood clustering algorithm. The aim of the algorithm is to divide a given set of points into &#8220;K&#8221; partitions. &#8220;K&#8221; needs to be specified
by the user. In order to understand K-Means, first you need to understand the proceeding concepts and their meaning.</p>
<ol class="arabic">
<li><dl class="first docutils">
<dt>Centroids</dt>
<dd><p class="first last">Centroids can be defined as the center of each cluster. If we are performing clustering with k=3, we will have 3 centroids. To perform K-Means clustering, the users needs to
provide the initial set of centroids.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Distance</dt>
<dd><p class="first last">In order to group data points as close together or as far-apart we need to define a distance between two given data points. In K-Means clustering distance is normally calculated as the Euclidean
Distance between two data points.</p>
</dd>
</dl>
</li>
</ol>
<p>The K-Means algorithm simply repeats the following set of steps until there is no change in the partition assignments, in that it has clarified which data point is
assigned to which partition.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Choose K points as the initial set of centroids.</li>
<li>Assign each data point in the data set to the closest centroid (this is done by calculating the distance between the data point and each centroid).</li>
<li>Calculate the new centroids based on the clusters that were generated in step 2. Normally this is done by calculating the mean of each cluster.</li>
<li>Repeat steps 2 and 3 until data points do not change cluster assignments, meaning their centroids are set.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="pseudo-code">
<h2>Pseudo Code<a class="headerlink" href="#pseudo-code" title="Permalink to this headline">¶</a></h2>
<p>Denote:</p>
<ul class="simple">
<li>N is the number of data points</li>
<li>M is the number of centroids</li>
<li>D is the dimension of centroids</li>
<li>Vi refers to the ith data point(vector)</li>
<li>Cj refers to the jth centroid</li>
</ul>
<div class="section" id="the-main-method">
<h3>The Main Method<a class="headerlink" href="#the-main-method" title="Permalink to this headline">¶</a></h3>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">generate</span> <span class="n">N</span> <span class="n">data</span> <span class="nf">points</span> <span class="o">(</span><span class="n">D</span> <span class="n">dimensions</span><span class="o">),</span> <span class="n">write</span> <span class="n">to</span> <span class="n">HDFS</span>
<span class="n">generate</span> <span class="n">M</span> <span class="n">centroids</span><span class="o">,</span> <span class="n">write</span> <span class="n">to</span> <span class="n">HDFS</span>
<span class="k">for</span> <span class="n">iterations</span><span class="o">{</span>
    <span class="n">configure</span> <span class="n">a</span> <span class="n">job</span>
    <span class="n">launch</span> <span class="n">the</span> <span class="n">job</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="the-mapper">
<h3>The Mapper<a class="headerlink" href="#the-mapper" title="Permalink to this headline">¶</a></h3>
<div class="highlight-java"><div class="highlight"><pre><span></span>load centroids

#The value of the input key-value pair is a data point Vi
find the nearest centroid Cj for the data point Vi
Context.write(j, &lt;Vi, 1&gt;)
</pre></div>
</div>
</div>
<div class="section" id="the-reducer">
<h3>The Reducer<a class="headerlink" href="#the-reducer" title="Permalink to this headline">¶</a></h3>
<div class="highlight-java"><div class="highlight"><pre><span></span>#The key is an ID of a centroid, the value list is a list of &lt;Vi, 1&gt;
newCentroid = a new D dimensional vector
count = 0
for each pair &lt;Vi, 1&gt; in the value list{
    for k in 0 to (D-1) {
        newCentroid[k] += Vi[k]
    }
    count += 1
}

for k in 0 to (D-1) {
        newCentroid[k] /= count
}

output newCentroid to HDFS
</pre></div>
</div>
</div>
</div>
<div class="section" id="compile-the-code">
<h2>Compile the Code<a class="headerlink" href="#compile-the-code" title="Permalink to this headline">¶</a></h2>
<p>The code is available at <a class="reference external" href="https://github.com/ADMIcloud/examples">https://github.com/ADMIcloud/examples</a>. Download the code by using the git clone command or by clicking the Download Zip button. Then go to the hadoop-kmeans directory and compile the code.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>git clone https://github.com/ADMIcloud/examples.git
<span class="nb">cd</span> examples/hadoop-kmeans
mvn clean install
</pre></div>
</div>
</div>
<div class="section" id="run-the-code">
<h2>Run the Code<a class="headerlink" href="#run-the-code" title="Permalink to this headline">¶</a></h2>
<p>The usage is:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">$HADOOP_PREFIX</span>/bin/hadoop jar target/hadoop-kmeans-1.0.jar admicloud.hadoop.kmeans.KmeansMain &lt;num Of Data Points&gt; &lt;size of a vector&gt; &lt;num of Centroids&gt; &lt;number of map tasks&gt; &lt;number of iterations&gt;
</pre></div>
</div>
<p>For example</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">$HADOOP_PREFIX</span>/bin/hadoop jar target/hadoop-kmeans-1.0.jar admicloud.hadoop.kmeans.KmeansMain <span class="m">100</span> <span class="m">3</span> <span class="m">10</span> <span class="m">2</span> 3
</pre></div>
</div>
<p>Hadoop K-means wil firstly generate 100 data points, each a 3-D vector. The data will be saved to HDFS. It then generates 10 initial centroids and writes them to HDFS. For every iteration, K-means loads centroids and reads key-value pairs to do computation, then writes new centroids back to HDFS.</p>
</div>
<div class="section" id="view-the-results">
<h2>View the Results<a class="headerlink" href="#view-the-results" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">$HADOOP_PREFIX</span>/bin/hdfs dfs -ls -R kmeans
kmeans/centroids
kmeans/centroids/centroids_0
kmeans/centroids/centroids_1
kmeans/centroids/centroids_2
kmeans/centroids/centroids_3
kmeans/data
kmeans/data/data_0
kmeans/data/data_1
kmeans/out
kmeans/out/_SUCCESS
kmeans/out/part-r-00000
</pre></div>
</div>
<p>In this example, data_0 and data_1 are data files. The data in file centroids_0 is the initial centroids. The data in file centroids_3 is the final result after 3 iterations.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><ul class="globaltoc"
><ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Cloud Computing Workshop</a></li>
<li class="toctree-l1"><a class="reference internal" href="schedule.html">Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="members.html">Members</a></li>
<li class="toctree-l1"><a class="reference internal" href="prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>

</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">ADMICloud  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, DSC.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>